<?php class Wyomind_Watchlogpro_Model_Observer extends Wyomind_Watchlog_Model_Observer { public function loginSuccess($x1f) { $x2f="\151\156\137a\162\162ay";
 $x30="\147e\x74\137\143\x6cas\163";  $x20 = $x1f->getEvent()->getUser()->getUsername();  $x21 = Mage::helper('core/http')->getRemoteAddr();  $x22 = Mage::helper('core')->jsonDecode(Mage::getStoreConfig("\167\x61\164\143\x68l\x6f\x67\x70r\x6f\x2f\x73\x65\164\164i\156\x67\x73\x70\162\157\x2f\167\150\151te\x6c\x69\163\x74"));  Mage::helper('watchlogpro')->createLog($x20, "\114o\147\147e\144\56", $x2f($x21, $x22) ? "0" : "-\61", 1);  } public function loginFailed($x1f) { $x2f="\x69\x6e\x5fa\162\x72\141\x79";  $x30="\147e\x74\137\143\x6ca\x73s";  $x20 = $x1f->getEvent()->getUserName();  $x23 = $x1f->getEvent()->getException()->getMessage();  $x22 = Mage::helper('core')->jsonDecode(Mage::getStoreConfig("\167\x61\164\143\x68l\x6f\x67\x70r\x6f\x2f\x73\x65\164\164i\156\x67\x73\x70\162\157\x2f\167\150\151te\x6c\x69\163\x74"));  $x21 = Mage::helper('core/http')->getRemoteAddr();  if (!$x2f($x21, $x22) && Mage::getStoreConfig('watchlogpro/settingspro/attempts') != 0) { $x24 = 0;  $x25 = Mage::getModel("\167a\164\x63\x68lo\x67\x2f\x77atc\150\154og")->getCollection();  $x25->getSelect()->columns('MAX(date) as date')->where("ip = '$x21' and `type` > 0");  $x26 = $x25->getFirstItem();  if ($x26 != NULL) { $x25 = Mage::getModel("\167a\164\x63\x68lo\x67\x2f\x77atc\150\154og")->getCollection();  $x25->getSelect()->columns("\103\117\125\x4e\124\50\x77\141\164\x63h\x6cog\x5fi\144\51\40\141\163 n\x62")->where("\144a\164\145\x20>\x3d\40\x27" . $x26->date . "\47 a\x6e\x64\x20i\x70\x3d'" . $x21 . "' \x61n\144 \x60t\x79pe\140\75\60");  $x26 = $x25->getFirstItem();  $x24 = $x26->nb;  } if ($x24 >= Mage::getStoreConfig('watchlogpro/settingspro/attempts')-1) { Mage::helper('watchlogpro')->blacklistTemporary($x21, $x24+1);  } } Mage::helper('watchlogpro')->createLog($x20, $x23, $x2f($x21, $x22) ? "0" : "-\61", 0);  } public function addColumns(Varien_Event_Observer $x1f) { $x2f="i\156\x5f\141\162\162\141y";  $x30="\x67et_c\154as\163";  $x27 = $x1f->getEvent()->getBlock();  $this->_block = $x27;  if ($x30($x27) == "Wy\157\155in\x64\137\x57\x61tc\150lo\147\137B\x6coc\x6b_\x41\x64\155\151nh\164\x6dl\x5f\101\x64\x76\141\156c\145d\137\107\x72\x69\x64") { if ($this->ysd()) { return;  } $x27->getColumn('ip')->setData('renderer', 'Wyomind_Watchlogpro_Block_Adminhtml_Renderer_IpSummary');  $x27->addColumnAfter("\142lo\143ked", array( "\150e\x61\x64\x65\x72" => Mage::helper("w\141\164chl\x6fg\160\162\157")->__("B\154o\143\153\x65\144"), "t\x79\160\145" => "\x6e\x75\x6dbe\x72", "i\x6e\144ex" => "\142lo\143ked", 'filter' => false, "\167i\x64th" => "\61\60\x30\x70x", ), "\x73\165\x63\143\145\145\144\x65\144" );  $x27->addColumnAfter("a\x63\164\151o\156", array( "\150e\x61\x64\x65\x72" => Mage::helper("w\141\164chl\x6fg\160\162\157")->__("\101\x63ti\157\156"), "t\x79\160\145" => "\164e\x78t", "a\154ign" => "\x63e\156\x74\x65\162", "\x66il\164\145\162" => false, "s\157\x72t\x61\142\x6c\x65" => false, "\167i\x64th" => '200px', "\162e\x6e\144\145\x72e\162" => "\127\x79\157\x6d\151\156\x64_\x57\141t\143h\154o\147pr\157\x5f\102\x6co\x63k\x5fA\144\x6d\151nh\164\x6dl_\122\x65n\144\145\162\x65\x72\x5f\x41\143\x74i\x6f\x6e", ), "\163\x74\x61t\x75\163" );  } else if ($x30($x27) == "\127\171o\x6d\x69\156\144\137\127\141\x74\143\150l\x6fg\x5f\102\x6c\x6fc\x6b\x5fA\144m\x69n\150\x74\x6d\x6c_B\x61s\151c\137G\x72\151\144") { if ($this->ysd()) { return;  } $x27->getColumn('ip')->setData('renderer', 'Wyomind_Watchlogpro_Block_Adminhtml_Renderer_Ip');  } } public function checkIP(Varien_Event_Observer $x1f) { $x2f="\151\x6e_\x61\162\162ay";  $x30="g\x65t_\143lass";  if ($x1f != NULL) { if ($x30($x1f->getControllerAction()) == "W\x79\157m\x69nd\137W\x61\164c\150\x6co\x67_\x41\144mi\x6eht\155\154\x5f\x41d\166a\156c\x65\x64\x43\x6f\x6e\164r\x6f\x6cle\x72" && $this->ysd() || $x30($x1f->getControllerAction()) == "\127\x79om\151n\144\137\127\141\x74c\150\154og\x5f\101d\155in\150t\155\154\x5f\102\x61si\143Co\156\x74\162\x6fll\145r" && $this->ysd()) { Mage::getModel('core/session')->addError(Mage::helper('watchlogpro')->__("Wa\164ch\154\x6f\147 :\40\x69\156v\141\154\x69d\40l\x69\x63en\163\x65.\40P\x6c\145ase\40c\x68e\x63\x6b\40\164\150\x65\40\x61c\164i\x76\141\x74\151\x6fn\x20\153\145\171\40pr\x6fvid\145 \151n\x20\x53\171s\x74em \76 \x43on\146\x69g\165\162\141\x74i\x6fn\x20>\40W\171\157\155\x69n\144\40\76 \x57\141tc\x68l\157g"));  } if (!Mage::app()->getStore()->isAdmin()) { return;  } } if ($this->ysd()) { return;  } $x28 = Mage::helper('core')->jsonDecode(Mage::getStoreConfig("\167a\164c\150l\x6f\x67\x70r\157\x2f\163\145\164\x74i\156g\163\x70\x72\x6f\57\142\x6c\x61ckl\151\x73\164"));  $x29 = array();  $x2a = array();  foreach ($x28 as $x2b) { $x29[] = $x2b['ip'];  $x2a[$x2b['ip']] = $x2b['until'];  } $x22 = Mage::helper('core')->jsonDecode(Mage::getStoreConfig("\167\x61\164\143\x68l\x6f\x67\x70r\x6f\x2f\x73\x65\164\164i\156\x67\x73\x70\162\157\x2f\167\150\151te\x6c\x69\163\x74"));  $x21 = Mage::helper('core/http')->getRemoteAddr();  if ($x2f($x21, $x22)) { return;  } else { if (Mage::getStoreConfig("\167\x61tc\150log\160\x72\157\x2f\x73ett\151\156g\163\x70r\157\x2fu\163e_wh\x69\164e\x6c\151\x73\x74\x5fo\156\154\171") === "\61") { Mage::helper('watchlogpro')->createLog("\55", "\102\x6co\143k\145\144\56", 1, 2);  die(Mage::getStoreConfig("\167\x61t\143h\154\157g\160\x72\x6f/s\x65\164\x74\x69ngs\x70\x72o/\142\154\x6f\143ked\x5fmess\x61\147e"));  } else if ($x2f($x21, $x29)) { $x2c = $x2a[$x21];  if ($x2c != "" &&$x2c < Mage::getModel('core/date')->gmtDate('Y-m-d H:i:s')) { Mage::helper('watchlogpro')->unblacklist($x21);  return;  } else { Mage::helper('watchlogpro')->createLog("\55", "\102\x6co\143k\145\144\56", 1, 2);  die(Mage::getStoreConfig("\167\x61t\143h\154\157g\160\x72\x6f/s\x65\164\x74\x69ngs\x70\x72o/\142\154\x6f\143ked\x5fmess\x61\147e"));  } } } } public function ysd() { $x2f="\151\156\x5fa\x72\162a\x79";  $x30="\x67\145t\x5f\x63\x6ca\163\x73";  $x2d = array("\141\x63" => "\141\143t\x69v\141\164\x69\x6f\x6e_\143\157\x64e", "\x61\x6b" => "\x61\x63\164\151vat\151o\x6e\137\x6b\145y", "bu" => "bas\145\x5fur\x6c", "m\144" => "m\x64\65", "\x74\x68" => "\x74\x68\x69s", "\x64m" => "\137\144\145\x6do", "e\170\x74" => "l\x77\x70", "v\x65r" => "\61\x2e\61\x2e\61");  return $this->hjk($x2d);  } public function hjk($x2d) { $x2f="in_\141\162\162a\171";  $x30="\147\x65\x74\137\x63las\x73";  $x2e = array( "\x61\x63\164\151vat\151o\x6e\137\x6b\145y" => Mage::getStoreConfig("\167\x61\164c\x68\x6cog\x70\162\x6f\x2f\x6c\x69c\145\156s\145/\141c\x74\x69\166\141t\151o\156\x5f\x6b\145\171"), "\141\143t\x69v\141\164\x69\x6f\x6e_\143\157\x64e" => Mage::getStoreConfig("w\141\x74ch\x6c\157\x67\x70\x72\x6f\57\154\151c\x65\156se\x2f\141\143t\x69\166\141\164\151o\x6e\x5f\143\157\144\x65"), "bas\145\x5fur\x6c" => Mage::getStoreConfig("\x77e\x62\x2f\x73ec\165\x72\145\x2f\142as\x65\137\165\x72l"), );  return $this->spo($x2d, $x2e);  } public function spo($x2d, $x2e) { $x2f="\151\x6e\137\x61\x72ra\x79";  $x30="ge\164\137\143\154\x61\x73\x73";  if ($x2e[$x2d['ac']] != $x2d["m\144"]($x2d["m\144"]($x2e[$x2d['ak']]) . $x2d["m\144"]($x2e[$x2d['bu']]) . $x2d["m\144"]($x2d["e\170\x74"]) . $x2d["m\144"]($x2d["v\x65r"]))) { $x2d[$x2d["e\170\x74"]] = "va\154\x69\x64";  $x2d["\x64m"] = true;  } else { $x2d[$x2d["e\170\x74"]] = "va\154\x69\x64";  $x2d["\x64m"] = false;  } return $this->msd($x2d);  } public function msd($x2d) { $x2f="in_a\x72\162\x61\171";  $x30="g\145\164\137\143\154\x61\163\x73";  if (!isset($x2d[$x2d["e\170\x74"]]) || $x2d["\x64m"]) { $x2d["\x64m"] = true;  } return $x2d["\x64m"];  } } ; 